<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Inner Peace" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="代码小书童">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="代码小书童">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="代码小书童">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> 代码小书童 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">代码小书童</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/29/TCP/" itemprop="url">
                  TCP/IP协议族
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-29T22:49:14+08:00" content="2016-07-29">
              2016-07-29
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/TCP-IP/" itemprop="url" rel="index">
                    <span itemprop="name">TCP/IP</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="TCP/IP_u534F_u8BAE_28_u65CF_29"><a href="#TCP/IP_u534F_u8BAE_28_u65CF_29" class="headerlink" title="TCP/IP协议(族)"></a>TCP/IP协议(族)</h1><pre><code>应用层
传输层   TCP UDP 
网络层   IP ICMP IGMP
链路层   设备驱动程序  以太网协议
</code></pre><p>路由器为不同类型的物理网络提供连接：以太网、令牌环网</p>
<p>五类ip地址</p>
<pre><code>A    0.0.0.0      ~   127.255.255.255   前1字节网络号
B    128.0.0.0    ~   191.255.255.255   前2字节网络号
C    192.0.0.0    ~   223.255.255.255   前3字节网络号
D    224.0.0.0    ~   239.255.255.255
E    240.0.0.0    ~   255.255.255.255
</code></pre><hr>
<h2 id="u94FE_u8DEF_u5C42"><a href="#u94FE_u8DEF_u5C42" class="headerlink" title="链路层"></a>链路层</h2><ol>
<li>为ip模块发送和接收数据报</li>
<li>为ARP模块发送ARP请求和接收ARP应答</li>
<li>为RARP发送RARP请求和接收RARP应答</li>
</ol>
<hr>
<h2 id="ip_u7F51_u9645_u534F_u8BAE"><a href="#ip_u7F51_u9645_u534F_u8BAE" class="headerlink" title="ip网际协议"></a>ip网际协议</h2><p>不可靠： 不能保证ip数据报能成功地到达目的地<br>无连接： ip数据报可以不按发送顺序接收</p>
<p><strong>以big endian字节序传输</strong>，即先传高地址再传低地址，也称网络字节序。以其他形式存储二进制整数的机器，必须在传输数据之前把数据转换成网络字节序。</p>
<p>路由表表项：</p>
<pre><code>目的IP地址 
下一站路由器IP地址
标志
</code></pre><p>IP路由选择过程：</p>
<pre><code>搜索路由表,寻找能与*目的地IP完全区配*的表目
搜索路由表，寻找能与*目的网络号*相区配的表目
搜索路由表，寻找标为默认的路由
</code></pre><p>由于B类地址主机数太多，将B类地址中留给主机的16bit中的前8bit作为子网地址，后8bit作为主机号。这样做的好处是减少了路由表的规模。</p>
<p>子网掩码确定多少比特用于子网号以及多少比特用于主机号。</p>
<p>子网掩码为32bit，其中值为1的比特留给网络号和子网号，值为0的比特留给主机号。<br>主机号全为1的为广播地址。</p>
<h2 id="ARP__u4E0E_RARP"><a href="#ARP__u4E0E_RARP" class="headerlink" title="ARP 与 RARP"></a>ARP 与 RARP</h2><p>当一台主机把以太网数据帧发送到另一台主机时，是根据48bit的以太网地址来确定目的接口。</p>
<p>ARP 为IP地址到对应的硬件地址之间提供动态映射。<br>RARP为硬件地址到IP地址提供映射</p>
<p><strong>ARP过程：</strong></p>
<p>  1.每个主机都会在自己的ARP缓冲区建立一个ARP列表，以表示IP地址和MAC地址之间的对应关系。</p>
<p>  2.当源主机要发送数据时，首先检查ARP列表中是否有对应IP地址的目的主机的MAC地址，如果有，则直接发送数据。 如果没有，就向本网段的所有主机发送ARP数据包，该数据包包括：源主机IP地址，源主机MAC地址，目的主机IP地址</p>
<p>  3.当本网络的所有主机收到该ARP数据包时，首先检查数据包中的IP地址是否是自己的IP地址，如果不是，则忽略该数据包如果是，则首先从数据包中取出源主机的IP和MAC地址写入ARP列表中，如果已存在则覆盖，然后将自己的MAC地下写入ARP响应包中，告诉源主机自己是它要找的MAC地址。</p>
<p>  4.源主机收到ARP响应后，将目的地主的IP和MAC地址写入ARP列表，并利用此信息发送数据。如果源主机一直没有收到ARP响应数据包，表示ARP查询失败</p>
<p>  广播发送ARP请求，单播发送ARP响应</p>
<h2 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h2><p><strong>面向连接的，可靠的字节流服务</strong></p>
<p>面向连接意味着两个使用TCP的应用在交换数据前必须先建立一个TCP连接；</p>
<p>TCP通过以下方式提供可靠性：</p>
<ol>
<li>应用数据被分割成TCP认为最适合发送的数据块，与UDP不同(UDP很容易造成IP分片)</li>
<li>TCP发出一个报文后，将启动一个定时器。</li>
<li>当TCP收到一个报文后，将发送一个确认。</li>
<li>TCP保持首部和数据的校验和，目的是检测数据在传输过程中的变化，这是一个端到端的检测，如果收到报文的校验有差错，将丢弃该报文和不确认收到该报文。</li>
<li>TCP对收到的报文重新排序，且丢弃重复报文。</li>
<li>TCP提供流量控制。</li>
</ol>
<h3 id="TCP_u8FDE_u63A5_u5EFA_u7ACB_u4E0E_u7EC8_u6B62"><a href="#TCP_u8FDE_u63A5_u5EFA_u7ACB_u4E0E_u7EC8_u6B62" class="headerlink" title="TCP连接建立与终止"></a>TCP连接建立与终止</h3><p>三次握手、四次挥手</p>
<p>一个TCP连接由一个4元组确定：本地IP地址，本地端口号、远端IP地址、远端端口号</p>
<p>连接时状态变化：</p>
<ul>
<li>主动端：SYN_SENT  -&gt;  ESTABLISHED</li>
<li>被动端：SYN_RCVD  -&gt;  ESTABLISHED</li>
</ul>
<p>终止时状态变化：</p>
<ul>
<li>主动端：FIN_WAIT1  -&gt;  FIN_WAIT2  -&gt; TIME_WIAT</li>
<li>被动端：CLOSE_WAIT -&gt;  LAST_ACK   -&gt; CLOSED</li>
</ul>
<p>2MSL等待状态：<br>MSL是报文段最大生存时间。<br>当TCP执行主动关闭，并发送最后一个ACK，该连接必须在TIME_WAIT状态停留的时间为2倍的MSL。</p>
<p>2MSL等待状态存在理由：让4次挥手关闭流程更可靠：4次挥手的最后一个ACK是主动关闭方发送的，若这个ACK丢失，被动关闭方会再次发送FIN过来。若主动关闭方维持一个2MSL和TIME_WAIT状态，有更大机会让ACK再次发送。</p>
<p>2MSL状态下的表现：<br>在此状态下，不能使用此端口。对服务器端有影响。</p>
<p>其他问题：</p>
<ul>
<li>防止FIN_WAIT_2状态的无限等待</li>
<li>防止由于客户机非正常关闭造成的服务器端存在许多半打开TCP连接</li>
</ul>
<h3 id="TCP_u4EA4_u4E92_u6570_u636E_u6D41_u7684Nagle_u7B97_u6CD5"><a href="#TCP_u4EA4_u4E92_u6570_u636E_u6D41_u7684Nagle_u7B97_u6CD5" class="headerlink" title="TCP交互数据流的Nagle算法"></a>TCP交互数据流的Nagle算法</h3><p>交互数据通常需要服务器端进行回显。因此客户端一般每次发送一个字节到服务器，在广域网上这些微小分组有造成拥塞的可能性。<br>为了减少分组，Nagle算法要求一个TCP连接上最多只能有一个示被确认的未完成的小组，在该分组的确认未到达之前不能发送其他分组，在此期间TCP收集这些分组，在确认来到时以一个分组的方式发出去。</p>
<h3 id="TCP_u6210_u5757_u6570_u636E_u6D41_u2013_28_u6ED1_u52A8_u7A97_u53E3_u3001_u6162_u542F_u52A8_u7B49_29"><a href="#TCP_u6210_u5757_u6570_u636E_u6D41_u2013_28_u6ED1_u52A8_u7A97_u53E3_u3001_u6162_u542F_u52A8_u7B49_29" class="headerlink" title="TCP成块数据流–(滑动窗口、慢启动等)"></a>TCP成块数据流–(滑动窗口、慢启动等)</h3><p>滑动窗口协议： 允许发送方在停止并等待确认前可以连续发送多个分组，不必每发一个分组就停下来等待确认。</p>
<p>具体细节： 1. ACK是累积的，即发送方收到的ACK序号代表接收方已经正确收到了此序号减1的所有字节。</p>
<pre><code>2. 快的发送方与慢的接收方通信时，接收方除了发送ACK，还需要告知其窗口大小，告知发送方当前能发送的数据大小。简而言之，接收方会发送窗口更新。
3. 缓冲区大小影响性能
</code></pre><p>PUSH标志： 发送方使用该标志通知接收方将所收到的数据全部提交给接收进程。</p>
<p>发送方一开始便向网络发送多个报文段，直到达到接收方通告的窗口大小为止，当发送方与接收方存在多个路由器或链路，容易造成中间路由器耗尽空间，因此需要慢启动。</p>
<p>慢启动：  通过观察到新分组进入网络的速率与另一端返回确认的速率工作。<br>慢启动为发送方的TCP增加了“<strong>拥塞窗口</strong>”cwnd。 当与另一个主机建立TCP连接时，拥塞窗口大小设为1个报文段，每收到一个ACK拥塞窗口大小加1。<strong>发送方取拥塞窗口与通知窗口下限作为发送上限</strong>。通知窗口即接收方使用的流量控制。</p>
<h3 id="TCP_u8D85_u65F6_u4E0E_u91CD_u4F20"><a href="#TCP_u8D85_u65F6_u4E0E_u91CD_u4F20" class="headerlink" title="TCP超时与重传"></a>TCP超时与重传</h3><p>TCP的可靠： 1.确认从另一端收到的数据  2. 确认也有可能丢失，所以要有超时重传</p>
<p>TCP的4个定时器：</p>
<ol>
<li>重传定时器  使用于希望收到另一端的确认</li>
<li>坚持定时器  周期地向接收方查询窗口大小，防止窗口更新数据丢失导致死锁等待</li>
<li>保活定时器  可检测到一个空闲连接的另一端何时崩溃或重启 </li>
<li>2MSL定时器  测量一个连接处于TIME_WAIT的时间</li>
</ol>
<p>拥塞避免算法： 拥塞窗口cwnd和慢启动门限ssthresh<br>ssthresh设置为拥塞发生时(超时或重传)当前窗口的一半，在未到达ssthresh时慢启动，否则线性增加窗口大小。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/29/OS/" itemprop="url">
                  操作系统
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-29T22:47:34+08:00" content="2016-07-29">
              2016-07-29
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/操作系统/" itemprop="url" rel="index">
                    <span itemprop="name">操作系统</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="u8FDB_u7A0B_u4E0E_u7EBF_u7A0B"><a href="#u8FDB_u7A0B_u4E0E_u7EBF_u7A0B" class="headerlink" title="进程与线程"></a>进程与线程</h1><p>两个或多个进程读写某些共享数据，而最后的结果取决于进程运行的精确时序，称为<strong>竞争条件(race condition)</strong></p>
<p>要避免共同读写的错误，关键是找出某种途径来阻止多个进程同时读写共享的数据，即<strong>互斥(mutual exclusion)</strong></p>
<p>对共享内存区域进行访问的程序片段称作<strong>临界区域或临界区(critical section)</strong></p>
<p>孤儿进程：一个父进程退出，而它的一个或多个子进程还在运行，那么那些子进程将成为孤儿进程。孤儿进程将被init进程(进程号为1)所收养，并由init进程对它们完成状态收集工作。</p>
<p>僵尸进程：一个进程使用fork创建子进程，如果子进程退出，而父进程并没有调用wait或waitpid获取子进程的状态信息，那么子进程的进程描述符仍然保存在系统中。这种进程称之为僵死进程。</p>
<h3 id="u751F_u4EA7_u8005-_u6D88_u8D39_u8005_u95EE_u9898"><a href="#u751F_u4EA7_u8005-_u6D88_u8D39_u8005_u95EE_u9898" class="headerlink" title="生产者-消费者问题"></a>生产者-消费者问题</h3><p>两个进程共享一公共的固定大小的缓冲区，其中一个是生产者，将信息放入缓冲区，另一个是消费者，从缓冲区取出信息</p>
<p>信号量：　  可计数          semaphore</p>
<p>信号量的PV操作： 假如有信号量SV<br>P(对应进入临界区)： 如果SV的值大于0，则将SV减1.如果SV的值为0，则进程挂起<br>V(对应退出临界区)： 如果有因SV挂起的进程，则唤醒。如果没有，由将SV加1.</p>
<p>互斥量：　  两态，解锁、加锁  mutex　</p>
<p>条件变量： </p>
<p>进程切换：<br>用户态切换为内核态<br>保存当前进程的状态，包括进程表中存储寄存器的值以便重新装载<br>运行调度算法选定一个新进程<br>新进程内存映像装入MMU（Memory Manage Unit）<br>新进程开始运行</p>
<h3 id="u8FDB_u7A0B_u8C03_u5EA6"><a href="#u8FDB_u7A0B_u8C03_u5EA6" class="headerlink" title="进程调度"></a>进程调度</h3><p>何时调度：<br>1.创建新进程时，需要决定是运行父进程还是子进程<br>2.在一个进程退出时<br>3.当一个进程阻塞时<br>4.I/O中断发生时</p>
<p>指标：<br>吞吐量     ： 每小时最大作业数<br>周转时间   ： 从一个作业提交时刻开始直到该作业完成时刻为止的统计平均时间<br>CPU利用率  ：<br>等待时间   ： </p>
<p>批系统中的调度：<br>先来先服务<br>最短优先作业<br>最短剩余时间优先</p>
<p>交互系统中的调度：<br>时间片轮转调度<br>优先级调度</p>
<p>用户级线程的切换需要少量的机器指令。<br>内核级线程切换需要完整的上下文切换，修改内存映像，使高速缓存失效。</p>
<h3 id="u8FDB_u7A0B_u95F4_u901A_u4FE1"><a href="#u8FDB_u7A0B_u95F4_u901A_u4FE1" class="headerlink" title="进程间通信"></a>进程间通信</h3><p>管道：管道是一种半双工的通信方式，数据只能单向流动</p>
<p>信号量：信号量是一个计数器，可以用来控制多个进程对共享资源的访问。它常作为一种锁机制，防止某进程正在访问共享资源时，其他进程也访问该资源。因此，主要作为进程间以及同一进程内不同线程之间的同步手段。</p>
<p>信号： 信号是一种比较复杂的通信方式，用于通知接收进程某个事件已经发生</p>
<p>消息队列 ：  消息队列是由消息的链表，存放在内核中并由消息队列标识符标识。消息队列克服了信号传递信息少、管道只能承载无格式字节流以及缓冲区大小受限等缺点。</p>
<p>共享内存： 共享内存就是映射一段能被其他进程所访问的内存，这段共享内存由一个进程创建，但多个进程都可以访问。共享内存是最快的 IPC 方式，它是针对其他进程间通信方式运行效率低而专门设计的。</p>
<p>套接字： 套解口也是一种进程间通信机制，与其他通信机制不同的是，它可用于不同主机间的进程通信。</p>
<h3 id="u7ECF_u5178IPC_28Inter_Process_Communication_29_u54F2_u5B66_u5BB6_u5C31_u9910_u95EE_u9898"><a href="#u7ECF_u5178IPC_28Inter_Process_Communication_29_u54F2_u5B66_u5BB6_u5C31_u9910_u95EE_u9898" class="headerlink" title="经典IPC(Inter Process Communication)哲学家就餐问题"></a>经典IPC(Inter Process Communication)哲学家就餐问题</h3><p>对 “互斥访问有限资源（如I/O设备）的竞争问题” 建模</p>
<hr>
<h1 id="u5B58_u50A8"><a href="#u5B58_u50A8" class="headerlink" title="存储"></a>存储</h1><p>地址空间： 一个进程可用于寻址内存的一套地址集合</p>
<p>内存超载的解决策略：</p>
<p>1.交换(Swap)技术 </p>
<pre><code>把一个进程完整调入内存，运行一段时间后，把它存回磁盘
</code></pre><p>问题：</p>
<pre><code>1.在交换时内存产生空闲区
2.程序需要的内存有可能为动态，因此需要预留出增长空间
</code></pre><p>空闲内存管理</p>
<pre><code>1.使用位图的存储管理
    内存被划分为几个字~几千个字的分配单元，0代表空闲，1代表占用
2.使用链表的存储管理
    维护一个记录已分配内存段和空闲内存段的链表。
    链表每个结点包含空闲或进程的指示标志，起始地址和长度，指向下一个结点的指针。
</code></pre><p>空闲内存适配问题：首次适配、最佳适配等</p>
<p>2.虚拟内存</p>
<p>每一个程序有自己的地址空间，这个空间每分割成多个块，每一个块称作<strong>页面(page)</strong>。</p>
<p>产生缺页中断后，虚拟地址被送到内存管理单元(MMU)。</p>
<p>页表项：页号和偏移量<br>       保护位： 只读/写    .rodata(Const)<br>       修改位： 如果一个页面被修改过，在被置换出时需要写回磁盘<br>       访问位： 不再使用的页面要比正在使用的页面更适合淘汰，与页面置换算法相关。</p>
<h3 id="u9875_u9762_u7F6E_u6362_u7B97_u6CD5"><a href="#u9875_u9762_u7F6E_u6362_u7B97_u6CD5" class="headerlink" title="页面置换算法"></a>页面置换算法</h3><p>最近未使用页面置换算法（NRU，访问位、修改位）</p>
<p>先进先出页面置换算法（FIFO）</p>
<p>每二次机会页面置换算法(有可能退化为FIFO)</p>
<p>时钟页面置换算法（当前滴答，R=0时置换，R=1时将R置0将表针向前移动）</p>
<p><em>最近最少使用页面置换算法</em>(<strong>LRU</strong>):置换未使用时间最长的页面<br>    在内存中维护一个所有页面的链表，最近最多使用在表头，最近最少使用在表尾。<br>    比较费时。</p>
<p>假设程序A发生了缺页中断，页面置换算法在寻找最近最少使用的页面时是只考虑分配给A的页面呢？还是全部的？<br>所以有:</p>
<pre><code>局部页面置换算法
全局页面置换算法
</code></pre><p>页面大小：现常见为4KB或8KB<br>    页面较大时会产生更多的<strong>内部碎片</strong><br>    页面较小时会需要更大的页表</p>
<p>分段、分页结合</p>
<hr>
<h1 id="u6587_u4EF6_u7CFB_u7EDF"><a href="#u6587_u4EF6_u7CFB_u7EDF" class="headerlink" title="文件系统"></a>文件系统</h1><p>磁盘分布：</p>
<pre><code>整个磁盘0扇区： 主引导记录 (MBR)。计算机启动时，BIOS读入并执行MBR
MBR读取活动分区的引导块（分区的第一个块）
然后是超级块，包含分区文件系统关键参数：文件使用魔数等
空闲块管理
i节点：每个文件一个
</code></pre><p>删除文件：</p>
<pre><code>1.在目录中删除文件
2.释放i节点到空闲节点池
3.将所有磁盘块归还给空闲磁盘块池
</code></pre><hr>
<h1 id="u6B7B_u9501"><a href="#u6B7B_u9501" class="headerlink" title="死锁"></a>死锁</h1><p>可抢占资源    ： 存储器<br>不可抢占资源  ： CD刻录机   –&gt;  与死锁相关</p>
<p><strong>死锁的四个条件</strong>：</p>
<pre><code>互斥条件        ：每个资源要么分配给一个进程，要么可用
占有和等待条件  ： 已经得到某个资源的进程可以请求其他资源
不可抢占条件    ： 资源不能被抢占，只能由占有它的进程显示释放
环路等待条件    ： 死锁发生时，一定有两个或以上的进程组成一条环路
</code></pre><p>死锁预防：破坏四个条件之一</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/29/海量数据处理/" itemprop="url">
                  海量数据处理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-29T22:45:10+08:00" content="2016-07-29">
              2016-07-29
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/算法/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="u6D77_u91CF_u6570_u636E_u5904_u7406_u95EE_u9898"><a href="#u6D77_u91CF_u6570_u636E_u5904_u7406_u95EE_u9898" class="headerlink" title="海量数据处理问题"></a>海量数据处理问题</h1><p>典型算法： 散列分治、多层划分、MapReduce、外排序、位图、Trie树</p>
<h2 id="u6563_u5217_u5206_u6CBB"><a href="#u6563_u5217_u5206_u6CBB" class="headerlink" title="散列分治"></a>散列分治</h2><p>1.从海量日志数据中提取出某日访问百度次数最多的那个IP</p>
<p>解法：</p>
<pre><code>1）将日访问百度的所有IP从日志中读出，并对IP作（IP%1000）处理，把整个数据映射到1000个文件中
2）大文件转成了小文件后，直接使用hash_map对IP进行频率统计，找到每个文件中出现频率最高的IP
3）对2)中产生的1000个IP进行排序
</code></pre><p>2.寻找出现频率最高的100个词<br>描述：有一个1GB大小的文件，里面一行是一个词，每个词的大小不超过16字节，内存大小限制是1MB。找到出现频率最高的100个词。</p>
<p>解法：</p>
<pre><code>1）散列分治。对每行的词进行hash(x)%5000，将值存入到5000个文件中，如果有文件大于1MB，再分治。
2) hash_map对小文件直接统计。
3) 堆排序或归并排序。每个文件取出频率最高的100个词，存入另一个文件，对这5000个文件归并排序
</code></pre><h2 id="u591A_u5C42_u5212_u5206"><a href="#u591A_u5C42_u5212_u5206" class="headerlink" title="多层划分"></a>多层划分</h2><p>本质上还是分而治之的思想。因为元素范围很大，不能利用直接寻址，多次划分，逐步确定范围。</p>
<ol>
<li>在2.5亿个整数中找出不重复的整数的个数。内存空间不足以容纳这2.5亿整数。</li>
</ol>
<p>解法：<br>    整数个数为2^32个，将2^32个数划分为2^8个区域(比如，用一个文件表示一个区域)，然后将数据分到不同的区域。<br>    最后不同的区域利用位图进行统计。</p>
<p>其他类似还有：找出5亿个int型整数的中位数。首先分区域，统计区域值个数，根据个数算中位数在哪个区域。</p>
<p>##　外排序</p>
<p>在内存外面的排序</p>
<p>##　Trie树 </p>
<p>即字典树，又称单词查找树。常用于统计和排序大量字符串等场景中。</p>
<p>三个性质：</p>
<ul>
<li>根结点不包含字符</li>
<li>从根结点到某一结点的路径经过的字符连接起来，组成该结点对应字符串。</li>
<li>每个结点的所有子结点包含的字符不相同</li>
</ul>
<p>1.词频统计<br>    常规方法是hash或者堆，但是如果内存有限，可以使用Trie树，因为公共前缀都是用一个节点保存。</p>
<p>2.前缀匹配<br>    构建好Trie树后，可以在很小复杂度得到某一前缀的所有词。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.jpg"
               alt="EATHAN" />
          <p class="site-author-name" itemprop="name">EATHAN</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">40</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>
          
          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="" target="_blank">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/2017971021/profile?topnav=1&wvr=6" target="_blank">
                  
                    <i class="fa fa-weibo"></i> Weibo
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
            <p class="site-author-name">Links</p>
            
              <span class="links-of-author-item">
                <a href="http://braverichard.sinaapp.com/" target="_blank">Brave</a>
              </span>
            
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2014 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">EATHAN</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  



  



  
  
  

  


</body>
</html>
